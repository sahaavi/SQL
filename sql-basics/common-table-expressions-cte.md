# Common Table Expressions (CTE)

CTE's are very similar to subqueries. In terms of their usage many times these are used interchangeably with subqueries.

<figure><img src="../.gitbook/assets/image (52) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (54) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (53) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (56) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (57) (1).png" alt=""><figcaption></figcaption></figure>

[you might be wondering, what's the difference ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[and how should I go about deciding when to use ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[one versus the other? ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[Aside from the obvious syntactical differences, ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[there are a few other defining characteristics ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[of each type of operation, but as it turns out, ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[a lot of it depends on the use case you're dealing with ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[and your preferences. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[On one hand, CTEs are generally more readable ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[and organized than subqueries, ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[because they can break more complex queries ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[down into smaller, more manageable chunks. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[Because CTEs can continue to be referenced multiple times ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[throughout the query, ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[they can also cut down on query length. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[And since they don't depend on the main query, ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[CTEs can be easier to reuse in future queries ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[for other use cases. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[Subqueries tend to be more concise for simple queries. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[Since they're older, subqueries are better supported ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[across most database engines. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[Subqueries have been around since SQL's creation ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[in the '70s. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[While CTEs have only been around since the late '90s. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[since the CTE appeared later, ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[it's not always supported by some older database engines ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[or the tools that came before it. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[Subqueries also take up less memory. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[Since Subqueries cannot be referenced ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[multiple times like CTEs, they're not stored in memory ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[and they're discarded once they're used. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[This can be an advantage in working with large data sets ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[or instances where memory allocation is a concern. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[Overall, the performance differences ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[across CTEs and subqueries vary depending on the use case ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[it's applied to, ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[as well as how well optimized ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[the query is written by the developer. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[In general, subqueries tend to be more efficient ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[when working with smaller data sets, ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)[while CTEs tend to be more efficient with larger data sets. ](https://www.linkedin.com/learning/top-five-things-to-know-in-advanced-sql/difference-between-a-cte-and-a-subquery?autoSkip=true\&contextUrn=urn%3Ali%3AlyndaLearningPath%3A5ee163f0498efe0ef0dfd87c\&resume=false)
